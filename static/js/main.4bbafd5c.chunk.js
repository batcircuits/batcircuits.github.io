(this["webpackJsonpbat-tree-test"]=this["webpackJsonpbat-tree-test"]||[]).push([[0],{19:function(e,t,n){},20:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var i=n(1),s=n.n(i),a=n(5),c=n.n(a),o=(n(19),n(10)),r=n(11),l=n(2),h=n(14),u=n(13),d=(n(20),n(0)),b=function(e){return Object(d.jsx)("div",{children:e.animations.map((function(t,n){return Object(d.jsx)("div",{children:Object(d.jsx)("button",{className:"pattern-button",onClick:function(){e.onAnimationClick(n)},children:t.name})},n)}))})},g=function(e){return Object(d.jsx)("div",{className:"header",children:Object(d.jsx)("h1",{children:e.title})})},m=function(e){return Object(d.jsx)("div",{children:e.patterns.map((function(t,n){return Object(d.jsx)("div",{children:Object(d.jsx)("button",{className:"pattern-button",onClick:function(){e.onPatternClick(n)},children:t.name})},n)}))})},j=n(12),f=n.n(j),v=function(e){return Object(d.jsxs)(f.a,{isOpen:e.settingsActive,onRequestClose:e.handleModalClose,contentLabel:"Settings",ariaHideApp:!1,closeTimeoutMS:200,className:"modal",children:[Object(d.jsx)("h3",{className:"modal__title",children:"Settings"}),Object(d.jsx)("p",{className:"modal__desc",children:"Brightness"}),Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{className:"setButt",onClick:e.decBrightness,children:"-"}),Object(d.jsx)("input",{className:"setText",type:"text",disabled:!0,value:e.brightPct}),Object(d.jsx)("button",{className:"setButt",onClick:e.incBrightness,children:"+"})]}),Object(d.jsx)("p",{className:"modal__desc",children:"Volume"}),Object(d.jsxs)("div",{children:[Object(d.jsx)("button",{className:"setButt",onClick:e.decVolume,children:"-"}),Object(d.jsx)("input",{className:"setText",type:"text",disabled:!0,value:e.volPct}),Object(d.jsx)("button",{className:"setButt",onClick:e.incVolume,children:"+"})]}),Object(d.jsx)("button",{className:"specialButton",onClick:e.handleModalClose,children:"Okie Dokie"})]})},C="connect",p=0,x=0,T=0,O=0,w=function(e){Object(h.a)(n,e);var t=Object(u.a)(n);function n(e){var i;return Object(o.a)(this,n),(i=t.call(this,e)).state={connected:!1,settingsActive:!1,allPatterns:[],allAnimations:[],brightness:0,volume:0},i.batTreeDevice=void 0,i.batTreeCharacteristic=void 0,i.onClickConnect=function(){var e=[];e.push({name:"BAT Tree"});var t=["0000ffe0-0000-1000-8000-00805f9b34fb"];console.log(t);var n={};n.filters=e,n.optionalServices=t,console.log("Requesting Bluetooth Device..."),console.log("with "+JSON.stringify(n)),navigator.bluetooth.requestDevice(n).then((function(e){return console.log("Connecting to GATT Server..."),i.batTreeDevice=e,i.batTreeDevice.gatt.connect()})).then((function(e){return console.log("Getting Primary Service..."),e.getPrimaryService(65504)})).then((function(e){return console.log("Getting Custom Characteristic..."),e.getCharacteristic(65505)})).then((function(e){console.log("We got all the way to the end!"),i.batTreeCharacteristic=e,i.batTreeCharacteristic.addEventListener("characteristicvaluechanged",i.handleChangeBlah),i.batTreeCharacteristic.startNotifications(),i.setState((function(){return{connected:!0}}))})).then((function(){C="queryNumPat",i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("NumPat\n"))})).catch((function(e){console.log("WRONG! "+e)}))},i.handleModalClose=function(){i.setState((function(){return{settingsActive:!1}}))},i.setPattern=function(e){i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("SetPat ".concat(e,"\n")))},i.setAnimation=function(e){i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("SetAni ".concat(e,"\n")))},i.handleIncBright=function(){C="queryBright",i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("IncBright\n"))},i.handleDecBright=function(){C="queryBright",i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("DecBright\n"))},i.handleIncVol=function(){C="queryVol",i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("IncVol\n"))},i.handleDecVol=function(){C="queryVol",i.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("DecVol\n"))},i.handleChangeBlah=i.handleChangeBlah.bind(Object(l.a)(i)),i}return Object(r.a)(n,[{key:"handleChangeBlah",value:function(e){var t=String.fromCharCode.apply(null,new Uint8Array(e.target.value.buffer));if("EOE"!==t)if("queryNumPat"===C){if(p=parseInt(t),console.log("The number of patterns is "+p),0===p)return void console.log("Uh... I guess I need to handle this. But for now, it will break me.");this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("GetPat 0\n")),x=0,C="gatherPatterns"}else if("gatherPatterns"===C){console.log("Pattern "+x+": "+t);var n=this.state.allPatterns;if(n.push({name:t,index:x}),x++,this.setState((function(){return{allPaterns:n}})),p>x){var i="GetPat "+x+"\n";this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode(i))}else console.log("I have received all of my patterns?"),console.log(n),C="queryNumAni",this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("NumAni\n"))}else if("queryNumAni"===C){if(0===(T=parseInt(t)))return void console.log("Same blah blah broken blah blah");this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("GetAni 0\n")),C="gatherAnimations"}else if("gatherAnimations"===C){console.log("Animation "+O+": "+t);var s=this.state.allAnimations;if(s.push({name:t,index:O}),O++,this.setState((function(){return{allAnimations:s}})),T>O){var a="GetAni "+O+"\n";this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode(a))}else console.log("I have received all of my animations?"),console.log(s),this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("GetBright\n")),C="queryBright"}else if("queryBright"===C){var c=(parseInt(t)+1)/5*100;this.setState((function(){return{brightness:c}})),C="queryVol",this.batTreeCharacteristic.writeValueWithoutResponse((new TextEncoder).encode("GetVol\n"))}else if("queryVol"===C){var o=(parseInt(t)+1)/8*100;this.setState((function(){return{volume:o}})),C="readyToRock"}else console.log("Response: ".concat(t));else console.log("Let us ignore the EOE, shall we?")}},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(g,{title:"BAT Controller"}),!this.state.connected&&Object(d.jsx)("button",{className:"specialButton",onClick:this.onClickConnect,children:"Connect"}),Object(d.jsxs)("div",{className:"container",children:[Object(d.jsx)(m,{patterns:this.state.allPatterns,onPatternClick:this.setPattern}),Object(d.jsx)(b,{animations:this.state.allAnimations,onAnimationClick:this.setAnimation}),this.state.connected&&Object(d.jsx)("button",{className:"specialButton",onClick:function(){e.setState((function(){return{settingsActive:!0}}))},children:"Settings"})]}),Object(d.jsx)(v,{settingsActive:this.state.settingsActive,handleModalClose:this.handleModalClose,brightPct:this.state.brightness,volPct:this.state.volume,incBrightness:this.handleIncBright,decBrightness:this.handleDecBright,incVolume:this.handleIncVol,decVolume:this.handleDecVol})]})}}]),n}(s.a.Component);c.a.render(Object(d.jsx)(s.a.StrictMode,{children:Object(d.jsx)(w,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.4bbafd5c.chunk.js.map