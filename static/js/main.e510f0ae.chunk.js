(this["webpackJsonpbat-tree-test"]=this["webpackJsonpbat-tree-test"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var o,i=n(1),a=n.n(i),c=n(8),r=n.n(c),l=(n(13),n(2)),s=n(4),u=n(5),h=n(7),d=n(6),f=(n(14),n(0)),b={},g={},v={},j={},p={},m=0,O=0,C=0,w=0,x=[];function k(e){return Object(f.jsx)("li",{children:Object(f.jsx)("button",{children:e.name})},e.name)}var y=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).title=e.title,o}return Object(u.a)(n,[{key:"render",value:function(){return Object(f.jsx)("div",{children:Object(f.jsx)("h1",{children:this.title})})}}]),n}(a.a.Component),E=function(e){Object(h.a)(n,e);var t=Object(d.a)(n);function n(e){var o;return Object(s.a)(this,n),(o=t.call(this,e)).onClickConnect=o.onClickConnect.bind(Object(l.a)(o)),o.handleChangeBlah=o.handleChangeBlah.bind(Object(l.a)(o)),o.state={connected:!1,allPatterns:[]},o}return Object(u.a)(n,[{key:"onClickConnect",value:function(){var e=this,t=[];t.push({name:"BAT Tree"});var n={};n.filters=t,n.optionalServices=[65504],console.log("Reqeusting Bluetooth Device..."),console.log("with "+JSON.stringify(n)),navigator.bluetooth.requestDevice(n).then((function(e){return console.log("Connecting to GATT Server..."),e.gatt.connect()})).then((function(e){return console.log("Getting Primary Service..."),e.getPrimaryService(65504)})).then((function(e){return console.log("Getting Custom Characteristic..."),e.getCharacteristic(65505)})).then((function(t){console.log("We got all the way to the end!"),(o=t).addEventListener("characteristicvaluechanged",e.handleChangeBlah),o.startNotifications(),e.setState((function(){return{connected:!0}}))})).then((function(){p=b,o.writeValueWithoutResponse((new TextEncoder).encode("NumPat\n"))})).catch((function(e){console.log("WRONG! "+e)}))}},{key:"handleChangeBlah",value:function(e){var t=String.fromCharCode.apply(null,new Uint8Array(e.target.value.buffer));if("EOE"!==t){if(p===b){if(m=parseInt(t),console.log("The number of patterns is "+m),0===m)return void console.log("Uh... I guess I need to handle this. But for now, it will break me.");o.writeValueWithoutResponse((new TextEncoder).encode("GetPat 0\n")),O=0,p=g}else if(p===g){console.log("Pattern "+O+": "+t);var n=this.state.allPatterns;if(n.push({name:t,index:O}),O++,this.setState((function(){return{allPaterns:n}})),m>O){var i="GetPat "+O+"\n";o.writeValueWithoutResponse((new TextEncoder).encode(i))}else console.log("I have received all of my patterns?"),console.log(n),p=v,o.writeValueWithoutResponse((new TextEncoder).encode("NumAni\n"))}else if(p===v){if(0===(C=parseInt(t)))return void console.log("Same blah blah broken blah blah");o.writeValueWithoutResponse((new TextEncoder).encode("GetAni 0\n")),p=j}else if(p===j)if(console.log("Animation "+w+": "+t),x.push({name:t,index:w}),w++,C>w){var a="GetAni "+w+"\n";o.writeValueWithoutResponse((new TextEncoder).encode(a))}else console.log("I have received all of my animations?"),console.log(x)}else console.log("Let us ignore the EOE, shall we?")}},{key:"render",value:function(){return Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(y,{title:"BAT Controller"}),!this.state.connected&&Object(f.jsx)("button",{onClick:this.onClickConnect,children:"Connect"}),Object(f.jsx)("ul",{children:this.state.allPatterns.map(k,this)})]})}}]),n}(a.a.Component);r.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(E,{})}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.e510f0ae.chunk.js.map